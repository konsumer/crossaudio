var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&o(e,a,t[a]);return e},l=(e,n)=>t(e,a(n)),c=(e,t)=>{var a={};for(var o in e)r.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&s.call(e,o)&&(a[o]=e[o]);return a};import{e as h,r as u,R as d,M as p,K as f,P as m,c as g,a as v}from"./vendor.54116816.js";let b;const y={},w=function(e,t){if(!t||0===t.length)return e();if(void 0===b){const e=document.createElement("link").relList;b=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in y)return;y[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":b,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))},k="undefined"!=typeof process&&process.versions&&process.versions.node;class x{constructor(e){this.values=e,this.watcher=h(),Object.keys(e).forEach((e=>{Object.defineProperty(this,e,{get:()=>this.values[e],set:t=>{this.values[e]=t,this.watcher.emit(e,t)}})}))}on(e,t){this.watcher.on(e,t)}off(e,t){this.watcher.off(e,t)}}const C=u.exports.createContext(),E=()=>u.exports.useContext(C),N=e=>{var t=e,{synth:a,params:n}=t,r=c(t,["synth","params"]);const[s,o]=u.exports.useState(n),h=u.exports.useRef(new x(n));u.exports.useEffect((()=>{!async function(e,t){let a,n;if(k){const r=(await w((()=>import("./index.1d77957d.js").then((function(e){return e.i}))),["/crossaudio/assets/index.1d77957d.js","/crossaudio/assets/___vite-browser-external_commonjs-proxy.87d401c7.js","/crossaudio/assets/vendor.54116816.js"])).StreamAudioContext;a=new((await w((()=>import("./index.f35e1207.js").then((function(e){return e.i}))),["/crossaudio/assets/index.f35e1207.js","/crossaudio/assets/___vite-browser-external_commonjs-proxy.87d401c7.js","/crossaudio/assets/vendor.54116816.js"])).default),n=new r,n.pipe(a),n.resume(),e(n,t)}else window.addEventListener("click",(()=>{n||(n=new AudioContext,n.resume(),e(n,t))}))}(a,h.current)}),[]);return d.createElement(C.Provider,l(i({},r),{value:[s,e=>{Object.keys(n).forEach((t=>{h.current[t]=e[t]})),o(e)}]}))},O=e=>{var t=e,{name:a="canvas"}=t,n=c(t,["name"]);const r=u.exports.useRef(),[s,o]=E();return u.exports.useEffect((()=>{r.current&&o(l(i({},s),{[a]:r.current}))}),[r.current]),d.createElement("canvas",l(i({},n),{ref:r}))},S=e=>440*Math.pow(2,(e-69)/12);function q(e,t){const a=e.createOscillator();a.frequency.value=S(t.note),a.type="sawtooth",a.start(0),t.on("note",(e=>{a.frequency.value=S(e)}));const n=e.createBiquadFilter();n.type="lowpass",n.frequency.value=S(t.cutoff),n.Q.value=t.resonance,t.on("cutoff",(e=>{n.frequency.value=S(e)})),t.on("resonance",(e=>{n.Q.value=e}));const r=e.createGain();r.gain.value=t.power?1:0,t.on("power",(e=>{r.gain.value=e?1:0})),a.connect(n),n.connect(r),r.connect(e.destination)}const j=()=>{const[e,t]=E(),a=a=>n=>t(l(i({},e),{[a]:parseInt(n.target.value)}));return d.createElement("div",{className:"synth"},d.createElement("div",null,d.createElement("label",null,"power:"),d.createElement("input",{type:"checkbox",onChange:a=>t(l(i({},e),{power:a.target.checked})),checked:e.power})),d.createElement("div",null,d.createElement("label",null,"note:"),d.createElement("input",{type:"range",value:e.note,onChange:a("note"),min:0,max:127}),d.createElement("div",{className:"value"},e.note)),d.createElement("div",null,d.createElement("label",null,"cutoff:"),d.createElement("input",{type:"range",value:e.cutoff,onChange:a("cutoff"),min:0,max:127}),d.createElement("div",{className:"value"},e.cutoff)),d.createElement("div",null,d.createElement("label",null,"resonance:"),d.createElement("input",{type:"range",value:e.resonance,onChange:a("resonance"),min:0,max:127}),d.createElement("div",{className:"value"},e.resonance)))},T=()=>d.createElement(N,{synth:q,params:{cutoff:48,resonance:2,power:!1,note:48}},d.createElement(j,null));var D={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},A={red:0,orange:60,yellow:120,green:180,blue:240,purple:300},I=function(e,t,a){return e*(1-a)+t*a};const P=["#000083","#000787","#000d8c","#001490","#001b94","#002199","#00289d","#002fa1","#0035a6","#003caa","#0047af","#0152b3","#015db8","#0167bd","#0172c2","#027dc6","#0288cb","#0293d0","#039ed5","#03a8d9","#03b3de","#03bee3","#04c9e7","#04d4ec","#04dff1","#04e9f6","#05f4fa","#05ffff","#14fff0","#22ffe1","#31ffd2","#40ffc3","#4fffb4","#5dffa5","#6cff96","#7bff87","#89ff78","#98ff69","#a7ff5a","#b5ff4b","#c4ff3c","#d3ff2d","#e2ff1e","#f0ff0f","#ffff00","#fff100","#fee300","#fed500","#fec600","#feb800","#fdaa00","#fd9c00","#fd8e00","#fd8000","#fc7100","#fc6300","#fc5500","#fb4700","#fb3900","#fb2a00","#fb1c00","#fa0e00","#fa0000","#ec0000","#df0000","#d10000","#c40000","#b60000","#a90000","#9b0000","#8e0000","#800000"];class R extends AnalyserNode{constructor(e,t,a=P,n=2,r=11250,s="red",o=-25,i=-60,l=.5,c=2048){super(e,{maxDecibels:o,minDecibels:i,smoothingTimeConstant:l,fftSize:c}),this.canvas=t,this.canvasContext=t.getContext("2d"),this.palette=a,this.speed=n,this.range=r,this.backgroundColor=s,this.drawing=!0}start(){var e;this.data=new Uint8Array(this.frequencyBinCount),this.colormap=(e=(e=this.palette).map((function(e){if("rgb"!=(e=function(e){var t,a,n=[],r=1;if("string"==typeof e)if(D[e])n=D[e].slice(),a="rgb";else if("transparent"===e)r=0,a="rgb",n=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var s=e.slice(1);r=1,(l=s.length)<=4?(n=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===l&&(r=parseInt(s[3]+s[3],16)/255)):(n=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===l&&(r=parseInt(s[6]+s[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),a="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var o=t[1],i="rgb"===o;a=s=o.replace(/a$/,"");var l="cmyk"===s?4:"gray"===s?1:3;n=t[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(e,t){if(/%$/.test(e))return t===l?parseFloat(e)/100:"rgb"===s?255*parseFloat(e)/100:parseFloat(e);if("h"===s[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==A[e])return A[e]}return parseFloat(e)})),o===s&&n.push(1),r=i||void 0===n[l]?1:n[l],n=n.slice(0,l)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(n=e.match(/([0-9]+)/g).map((function(e){return parseFloat(e)})),a=e.match(/([a-z])/gi).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(n=[e[0],e[1],e[2]],a="rgb",r=4===e.length?e[3]:1):e instanceof Object&&(null!=e.r||null!=e.red||null!=e.R?(a="rgb",n=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(a="hsl",n=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),r=e.a||e.alpha||e.opacity||1,null!=e.opacity&&(r/=100)):(a="rgb",n=[e>>>16,(65280&e)>>>8,255&e]);return{space:a,values:n,alpha:r}}(e)).space){if("hsl"!=e.space)throw"c.spacespace is not supported.";e.values=function(e){var t,a,n,r,s,o=e[0]/360,i=e[1]/100,l=e[2]/100;if(0===i)return[s=255*l,s,s];t=2*l-(a=l<.5?l*(1+i):l+i-l*i),r=[0,0,0];for(var c=0;c<3;c++)(n=o+1/3*-(c-1))<0?n++:n>1&&n--,r[c]=255*(s=6*n<1?t+6*(a-t)*n:2*n<1?a:3*n<2?t+(a-t)*(2/3-n)*6:t);return r}(e.values)}return e.values.push(e.alpha),e.values})),function(t,a){var n;a=a||I;var r=(e.length-1)*(t=(n=t)<0?0:n>1?1:n),s=Math.floor(r),o=Math.ceil(r);t=r-s;var i=e[o],l=e[s].map((function(e,n){return e=a(e,i[n],t),n<3&&(e=Math.round(e)),e}));return 1===l[3]?"rgb("+l.slice(0,3)+")":"rgba("+l+")"});const t=()=>{this.drawing&&window.requestAnimationFrame(t),this.getByteFrequencyData(this.data);const e=Float32Array.from(this.data).map((e=>e/255)),a=this.canvasContext.getImageData(0,0,this.canvas.width,this.canvas.height);this.backgroundColor&&(this.canvasContext.beginPath(),this.canvasContext.fillStyle=this.backgroundColor,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height)),this.canvasContext.putImageData(a,-this.speed,0);const n=this.range/this.context.sampleRate*e.length;for(const t in e)this.canvasContext.fillStyle=this.colormap(e[t]),this.canvasContext.fillRect(this.canvas.width-this.speed,~~(this.canvas.height-this.canvas.height/n*t),this.speed,Math.ceil(this.canvas.height/n)||1)};t()}stop(){this.drawing=!1}}class F extends AnalyserNode{constructor(e,t,a="black",n="white",r=-25,s=-60,o=.5,i=2048){super(e,{maxDecibels:r,minDecibels:s,smoothingTimeConstant:o,fftSize:i}),this.canvas=t,this.canvasContext=t.getContext("2d"),this.backgroundColor=n,this.foregroundColor=a,this.drawing=!0}start(){this.data=new Uint8Array(this.frequencyBinCount);const e=()=>{this.drawing&&window.requestAnimationFrame(e),this.getByteTimeDomainData(this.data),this.backgroundColor&&(this.canvasContext.beginPath(),this.canvasContext.fillStyle=this.backgroundColor,this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height)),this.canvasContext.strokeStyle=this.foregroundColor,this.canvasContext.beginPath();const t=1*this.canvas.width/this.frequencyBinCount;let a=!0,n=0;for(const e of this.data){const r=e/128*this.canvas.height/2;a?(a=!1,this.canvasContext.moveTo(n,r)):this.canvasContext.lineTo(n,r),n+=t}this.canvasContext.lineTo(this.canvas.width,this.canvas.height/2),this.canvasContext.stroke()};e()}stop(){this.drawing=!1}}const _=p.fromNote("c3"),L=p.fromNote("e4"),M=f.BOTTOM_ROW,B=f.create({firstNote:_,lastNote:L,keyboardConfig:M});class ${constructor(e,t,a){this.context=t,this.vco=t.createOscillator(),this.vco.frequency.value=S(e),this.vco.type="triangle",this.vca=t.createGain(),this.vca.gain.value=0,this.vca.gain.setTargetAtTime(a,t.currentTime,.015),this.vca.connect(t.destination),this.vco.start(),this.vco.connect(this.vca)}stop(){this.vca.gain.setTargetAtTime(0,this.context.currentTime,.1)}}const z=(e,t)=>{const a={};let n,r;t.on("canvas",(t=>{t&&!n&&(n=new R(e,t),n.start(),Object.values(a).forEach((e=>{e.spectrographSet=!0,e.vca.connect(n)})))})),t.on("canvas2",(t=>{t&&!r&&(r=new F(e,t),r.start(),Object.values(a).forEach((e=>{e.oscopeSet=!0,e.vca.connect(r)})))})),t.on("note",(({note:t,velocity:s,type:o})=>{"noteon"===o?(a[t]=new $(t,e,s/127/4),n&&!a[t].spectrographSet&&(a[t].spectrographSet=!0,a[t].vca.connect(n)),r&&!a[t].oscopeSet&&(a[t].oscopeSet=!0,a[t].vca.connect(r))):a[t]&&a[t].stop()}))},G=()=>{const[e,t]=E();return d.createElement("div",{className:"synth"},d.createElement("span",null,d.createElement(O,{name:"canvas",width:480,height:100,style:{marginRight:10}}),d.createElement(O,{name:"canvas2",width:480,height:100})),d.createElement(m,{noteRange:{first:_,last:L},playNote:a=>t(l(i({},e),{note:{note:a,velocity:100,type:"noteon"}})),stopNote:a=>t(l(i({},e),{note:{note:a,velocity:0,type:"noteoff"}})),width:1e3,keyboardShortcuts:B}))},Q=()=>d.createElement(N,{synth:z,params:{note:void 0,canvas:void 0,canvas2:void 0}},d.createElement(G,null)),U={};function V(e){var t=e,{components:a}=t,n=c(t,["components"]);return g("wrapper",l(i(i({},U),n),{components:a,mdxType:"MDXLayout"}),g("h1",null,"crossaudio"),g("h2",null,"quick start:"),g("pre",null,g("code",i({parentName:"pre"},{className:"language-sh"}),"npx coreaudio mysynth.js\n")),g("p",null,"Read more on ",g("a",i({parentName:"p"},{href:"https://github.com/konsumer/crossaudio/wiki/Getting-Started"}),"our wiki"),"."),g("h2",null,"demos"),g("h3",null,"lowpass filter"),g(T,{mdxType:"DemoSynth"}),g("p",null,g("a",i({parentName:"p"},{href:"https://github.com/konsumer/crossaudio/blob/main/packages/site/src/DemoSynth.jsx"}),"source")),g("hr",null),g("h3",null,"piano & graphs"),g(Q,{mdxType:"DemoSynth2"}),g("p",null,g("a",i({parentName:"p"},{href:"https://github.com/konsumer/crossaudio/blob/main/packages/site/src/DemoSynth2.jsx"}),"source")),g("hr",null),g("p",null,"The same synth code can also be used in plain javascript in the browser, and in a headless CLI or graphical app, without a browser."),g("p",null,"Check out these standalone (non-react, no build) demos:"),g("ul",null,g("li",{parentName:"ul"},g("a",i({parentName:"li"},{href:"bargraph.html"}),"bargraph")),g("li",{parentName:"ul"},g("a",i({parentName:"li"},{href:"spectrograph.html"}),"spectrograph")),g("li",{parentName:"ul"},g("a",i({parentName:"li"},{href:"oscilloscope.html"}),"oscilloscope"))))}V.isMDXComponent=!0,v.render(d.createElement(d.StrictMode,null,d.createElement(V,null)),document.getElementById("root"));
